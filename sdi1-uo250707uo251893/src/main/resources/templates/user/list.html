<!DOCTYPE html>
<html lang="en">
<head th:replace="fragments/head" />

<body>
	
	<!-- Barra de NavegaciÃ³n superior -->
	<nav th:replace="fragments/nav" />
	
	<div class="container">
		<h2 th:text="#{Title.user.list}">Usuarios</h2>

		<form class="navbar-form" action="/user/list">
			<div class="form-group">
				<input name="searchText" type="text" class="form-control" size="50"
					th:placeholder="#{Placeholder.user.list.search}">
			</div>
			<button type="submit" class="btn btn-default"
				th:text="#{Submit.user.list.search}">Buscar</button>
		</form>

		<p th:text="#{User.list.message}">
			Todos los usuarios:
		</p>
		
		<div th:fragment="tableUsersAndPagination" id="tableUsersAndPagination">
		
			<div class="table-responsive">
				<table class="table table-hover">
					<thead>
						<tr>
							<th th:text="#{user.name}">Nombre</th>
							<th th:text="#{user.email}">Email</th>
							<th sec:authorize="hasRole('ROLE_ADMIN')" class="col-md-1"></th>
						</tr>
					</thead>
					<tbody>
						<tr th:each="user : ${usersList}">
							<td th:text="${user.name + ' ' + user.lastName}">Nombre completo del usuario</td>
							<td th:text="${user.email}">Email del usuario</td>
							 
							<td sec:authorize="hasRole('ROLE_ADMIN')">
								<div>
									<button type="button" th:id="${'deleteUserButton' + user.id}"
										class="btn btn-default">Eliminar</button>
									<script th:inline="javascript">
										/*<![CDATA[*/
										$("#deleteUserButton[[${user.id}]]").click( function() {
											$.get("/user/delete/[[${user.id}]]", function(data) {
												var numberPage = [[${param.page}]];
												var sizePage = [[${param.size}]];
											  	var urlUpdate = '/user/list/update';
											  	if ( numberPage != null ){
											  		urlUpdate += "?page=" + numberPage[0];
											  	}
											  	if ( sizePage != null ){
											  		urlUpdate += "&size=" + sizePage[0];
											  	}
											  	$("#tableUsersAndPagination").load(urlUpdate);
											});
										});
										/*]]>*/
									</script>
								</div>
							</td>
	
						</tr>
					</tbody>
				</table>
			</div>
			
			<footer th:replace="fragments/pagination" />
			
		</div>
		
	</div>
	
	<footer th:replace="fragments/footer" />
	
</body>
</html>